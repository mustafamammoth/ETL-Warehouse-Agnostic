version: 2

sources:
  - name: acumatica_raw
    description: Raw data extracted from Acumatica API
    schema: public  # ‚Üê ADD THIS LINE - tells dbt to look in public schema
    tables:
      - name: raw_customers
        description: Customer master data from Acumatica
        columns:
          - name: id
            description: Unique customer identifier (GUID)
          - name: CustomerID
            description: Customer business ID (e.g., C000001)

      - name: raw_sales_invoices
        description: Sales invoices data from Acumatica
        columns:
          - name: id
            description: Unique invoice identifier (GUID)
          - name: ReferenceNbr
            description: Invoice reference number
          - name: CustomerID
            description: Customer business ID
          - name: Amount
            description: Total invoice amount
          - name: Type
            description: Invoice type (Invoice, Credit Memo, etc.)

      - name: raw_sales_orders
        description: Sales orders data from Acumatica
        columns:
          - name: id
            description: Unique sales order identifier (GUID)

      - name: raw_stock_items
        description: Stock items/products data from Acumatica
        columns:
          - name: id
            description: Unique stock item identifier (GUID)

models:
  - name: customers_raw
    description: Raw customer data with basic filtering
    columns:
      - name: customer_id
        description: Clean customer ID
        tests:
          - not_null
          - unique

  - name: sales_invoices_raw
    description: Raw sales invoices data with basic filtering
    columns:
      - name: invoice_number
        description: Clean invoice reference number
        tests:
          - not_null
          - unique
      - name: customer_id
        description: Customer identifier
        tests:
          - not_null

  - name: customers
    description: Cleaned and enhanced customer data
    columns:
      - name: customer_id
        tests:
          - not_null
          - unique

  - name: sales_invoices
    description: Cleaned and enhanced sales invoices data
    columns:
      - name: invoice_number
        tests:
          - not_null
          - unique
      - name: customer_id
        tests:
          - not_null
      - name: amount
        tests:
          - not_null
      - name: invoice_category
        tests:
          - accepted_values:
              values: ['Regular Invoice', 'Credit Memo']